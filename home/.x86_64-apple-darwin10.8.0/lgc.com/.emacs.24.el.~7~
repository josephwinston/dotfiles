;; -*- Emacs-Lisp -*-

;;
;; Fix "no access to tty (Bad file descriptor)"
;; See https://lists.gnu.org/archive/html/help-gnu-emacs/2004-08/msg00112.html
;;

(setq process-connection-type t)

;;
;; Old splitting mode
;;

(setq split-width-threshold nil)

;;
;; Set up bbdb
;;

;; (require 'bbdb)
;; (bbdb-initialize 'gnus 'message 'sc 'w3 'vm)

;;
;; Set up auctex
;;

;;
;; Enable parsing
;;

(setq TeX-auto-save t)			; Enable parse on load.
(setq TeX-parse-self t)			; Enable parse on save.
(setq-default TeX-master nil)

;;
;; Maximum decoration
;;

(setq font-lock-maximum-decoration t) 

;;
;; Add reftex
;;

(autoload 'turn-on-reftex "reftex")
(add-hook 'LaTeX-mode-hook 'turn-on-reftex) ; with AUCTeX LaTeX mode
(add-hook 'latex-mode-hook 'turn-on-reftex) ; with Emacs latex mode

;;
;; Add bib-cite
;;

;; (autoload 'turn-on-bib-cite "bib-cite")
;; (add-hook 'LaTeX-mode-hook 'turn-on-bib-cite)
;; (add-hook 'latex-mode-hook 'turn-on-bib-cite)

;;
;; Adjust the default directory
;;

(if (equal default-directory "/") 
    (setq default-directory "~/")
  )
 
;;
;; Help the compiler parsing
;;

(setq process-connection-type nil)

;;
;; spellingx
;;

(setq ispell-program-name "/opt/local/bin/aspell")

;;
;; p4
;;

;; (load-library "p4")
;; (setq p4-executable "/usr/local/bin/p4")

(setq auto-mode-alist
      (append
       '(("CMakeLists\\.txt\\'" . cmake-mode))
       '(("\\.cmake\\'" . cmake-mode))
       auto-mode-alist))

(autoload 'cmake-mode "~/Tools/share/emacs/site-lisp/cmake-mode.el" t)

;;
;; scala
;;

(add-to-list 'load-path "~/Tools/share/emacs/site-lisp/scala")
(require 'scala-mode-auto)

(defun scala-turnoff-indent-tabs-mode ()
  (setq indent-tabs-mode nil))

;;
;; scala mode hooks
;;

(add-hook 'scala-mode-hook 'scala-turnoff-indent-tabs-mode)

;;
;; csharp
;;

(autoload 'csharp-mode "~/Tools/share/emacs/site-lisp/csharp-mode" "Major mode for editing C# code." t)
(setq auto-mode-alist
      (append '(("\\.cs$" . csharp-mode)) auto-mode-alist))

;;
;; cuda
;;

(setq auto-mode-alist
      (append '(("\\.cu" . c++-mode)) auto-mode-alist))

;;
;; python mode
;;

(add-to-list 'load-path "~/Tools/share/emacs/site-lisp/python-mode.el-6.1.0/") 
(setq py-install-directory "~/Tools/share/emacs/site-lisp/python-mode.el-6.1.0/") 
(require 'python-mode)

(setq py-shell-name "/opt/local/bin/python2.7")

;;
;; clang and autocomplete
;;

(add-to-list 'load-path "~/.x86_64-apple-darwin10.8.0/lgc.com/auto-complete-1.3.1/")
(add-to-list 'load-path "~/.x86_64-apple-darwin10.8.0/lgc.com/emacs-clang-complete-async/") 

(defun ac-common-setup ()
  (setq ac-sources (append ac-sources '(ac-source-dictionary))))

(require 'auto-complete-clang-async)

(defun ac-cc-mode-setup ()
  (setq ac-clang-complete-executable "~/.x86_64-apple-darwin10.8.0/lgc.com/emacs-clang-complete-async/clang-complete")
  (setq ac-sources '(ac-source-clang-async))
  (ac-clang-launch-completion-process)
)

(defun my-ac-config ()
  (add-hook 'c-mode-common-hook 'ac-cc-mode-setup)
  (add-hook 'auto-complete-mode-hook 'ac-common-setup)
  (global-auto-complete-mode t))

(my-ac-config)


